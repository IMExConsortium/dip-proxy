<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:aop="http://www.springframework.org/schema/aop"
    xmlns:tx="http://www.springframework.org/schema/tx"
    xsi:schemaLocation="
      http://www.springframework.org/schema/beans 
      http://www.springframework.org/schema/beans/spring-beans-2.0.xsd
    
      http://www.springframework.org/schema/tx 
      http://www.springframework.org/schema/tx/spring-tx-2.0.xsd
      
      http://www.springframework.org/schema/aop 
      http://www.springframework.org/schema/aop/spring-aop-2.0.xsd">

 <!-- distributed hash configuration -->

 <!-- init-method="initialize"  -->

 <bean id="dht" class="edu.ucla.mbi.proxy.router.Dht" 
       destroy-method="cleanup">

  <property name="overlayMode" value="${dht.mode}" />
 
  <property name="maxDrlSize">
    <value>2</value>
  </property>

  <property name="routingAlgorithm">
    <value>${dht.routing}</value>
  </property>

  <property name="directoryType">
    <value>BerkeleyDB</value>
  </property>

  <property name="workingDirectory">
   <!--<value>/tmp/dip-proxy/dht</value> -->
   <value>dht</value>
  </property>

  <property name="defaultTTL">
    <value>3</value> <!-- 3 hours -->
  </property>
 
  <property name="dhtPort">
    <value>55666</value>    
  </property>
  
  <property name="bootServers">
    <list>
     <value>10.1.200.201</value>
<!--     <value>10.1.200.202</value>
     <value>10.1.200.203</value>
     <value>10.1.200.204</value>
     <value>10.1.200.205</value>
     <value>10.1.200.206</value>
     <value>10.1.200.207</value>
-->
     <value>10.1.200.208</value>
     <value>10.1.200.209</value>
     <value>10.1.200.210</value>
    </list>
  </property>

 </bean>

 <bean id="ebiSimpleRouter" 
    class="edu.ucla.mbi.proxy.router.SimpleRouter">

  <property name="config">
    <map>
      <entry key="proxy-url-list">
        <list>
          <value>http://10.1.200.209:8080/dip-proxy-server/proxy-service</value>
          <value>http://10.1.200.210:8080/dip-proxy-server/proxy-service</value>
        </list>
     </entry>
    </map>
  </property>
 </bean>

 <bean id="ebiDhtRouter" class="edu.ucla.mbi.proxy.router.DhtRouter">
  <property name="dht">
   <ref bean="dht"/>
  </property>
  <property name="proxyPort" value="8080"/>
 </bean>

 <bean id="ncbiDhtRouter" class="edu.ucla.mbi.proxy.router.DhtRouter">
  <property name="dht">
   <ref bean="dht"/>
  </property>
  <property name="proxyPort" value="8080"/>
 </bean>

 <bean id="mbiDhtRouter" class="edu.ucla.mbi.proxy.router.DhtRouter">
  <property name="dht">
   <ref bean="dht"/>
  </property>
  <property name="proxyPort" value="8080"/>
 </bean>

 <bean id="dipDhtRouter" class="edu.ucla.mbi.proxy.router.DhtRouter">
  <property name="dht">
   <ref bean="dht"/>
  </property>
  <property name="proxyPort" value="8080"/>
 </bean>

 <bean id="yeastMineDhtRouter" class="edu.ucla.mbi.proxy.router.DhtRouter">
  <property name="dht">
   <ref bean="dht"/>
  </property>
  <property name="proxyPort" value="8080"/>
 </bean>

 <!-- reference proxy -->
 <bean id="referenceProxy" init-method="initialize"
       class="edu.ucla.mbi.proxy.RemoteProxyServer">
  <property name="address">
   <value>
     http://%%URL%%/dip-proxy/proxy-service    
   </value>
  </property>
  <property name="context">
    <map/>
  </property>
 </bean>

 <!-- REST SERVER -->

 <bean id="nativeRestServer" init-method="initialize" 
       class="edu.ucla.mbi.proxy.NativeRestServer">

    <property name="context">
        <map>
            <entry key="restServerContext">
                <ref bean="restServerContext"/>
            </entry>
            <entry key="contextTop" value="restServer"/>
        </map>
    </property>
 </bean>


 <!-- EBI proxy services -->
 
 <bean id="ebiReferenceServer" init-method="initialize" 
       class="edu.ucla.mbi.proxy.ebi.EbiServer">

  <property name="context">
    <map>
      <entry key="picrEndpoint">  
        <value>http://www.ebi.ac.uk/Tools/picr/service</value>
      </entry>
      
      <entry key="searchDbList">
       <list>
        <value>SEGUID</value>
        <value>SWISSPROT</value>
        <value>SWISSPROT_VARSPLIC</value>
        <value>REFSEQ</value>
        <value>TREMBL</value>
        <value>TREMBL_VARSPLIC</value>
        <value>FLYBASE</value>
        <value>PIR</value>
        <value>SGD</value>
        <value>TAIR_ARABIDOPSIS</value>
        <value>PDB</value>
        <value>WORMBASE</value>
       </list>
      </entry>

      <entry key="nativeRestServer">
        <ref bean="nativeRestServer"/>
      </entry>
       
    </map>
  </property>
 </bean>

 <!-- NCBI proxy services -->
 
 <bean id="ncbiReferenceServer" init-method="initialize" 
       class="edu.ucla.mbi.proxy.ncbi.NcbiServer">

  <property name="context">
    <map>
       <entry key="nativeRestServer">
            <ref bean="nativeRestServer"/>
       </entry>

       <!-- param used by NcbiReFetchThread class -->
       <entry key="isRetry" value="true"/><!-- dbCache is on -->
       <entry key="timeout" value="600"/>
       <entry key="ttl" value="30"/>
       <entry key="threadRunMinutes" value="10"/> <!-- mins -->

    </map>
  </property>

 </bean>


 <!-- Prolinks proxy services -->
 
 <bean id="prlReferenceServer" init-method="initialize"
       class="edu.ucla.mbi.proxy.prolinks.ProlinksServer">
  <property name="context">
    <map>
        <entry key="nativeRestServer">
            <ref bean="nativeRestServer"/>              
        </entry>
        <entry key="ncbiProxyAddress">
            <!--<value>http://dip.doe-mbi.ucla.edu/dip-proxy/ncbi-service</value> -->
            <value> http://10.1.200.201:8080/dip-proxy-server/proxy-service</value>
        </entry>
    </map> 
  </property>
 </bean>
 
 <!-- DIP proxy services -->

 <bean id="dipReferenceServer" init-method="initialize"
       class="edu.ucla.mbi.proxy.dip.DipServer">

  <property name="context">
    <map>
      <entry key="dipLegacyEndpoint">
        <value>http://dip.doe-mbi.ucla.edu/dip-legacy/dxf</value>
      </entry>

      <entry key="dipEndpoint">
        <value>http://10.1.200.203:8080/dip-database-server/dxf-service</value>
      </entry>
    </map>
  </property>
 </bean>
 </beans>
